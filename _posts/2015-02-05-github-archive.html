---
layout: post
title: "Github Archive"
date:   2015-02-05 21:08:52
---

<p>
I recently thought it would be cool to show a list, here on the blog,
of all the projects that I've contributed to on Github. I googled
around a bit and found this <a href="http://stackoverflow.com/questions/20714593/github-api-repositories-contributed-to#answer-27643444">Stack Overflow answer</a>.
</p>

<p>
It turns out that Github has a project named <a href="https://www.githubarchive.org">Github Archive</a> which
stores all public activity on Github dating back to 2011-02-12. What is
even cooler is that this dataset is available on <a href="https://bigquery.cloud.google.com/">Google Big-query</a> and
it's updated by the hour!
</p>

<p>
I looked through the <a href="https://developer.github.com/v3/activity/events/types/#pullrequestevent">documentation</a> of the event I was interested in
(<code>PullRequestEvent</code>) and modified the query from the SO answer
slightly to also return the programming language of the repository and
the date of the my latest pull request. I ended up with the following
query. Keep in mind that this query only works for data
before 2015. See note at the bottom for more information.
</p>

<div class="org-src-container">

<pre class="src src-sql"><span style="color: #8ac6f2; font-weight: bold;">SELECT</span>
  repository_url,
  <span style="color: #e5786d;">LAST</span>(created_at) <span style="color: #8ac6f2; font-weight: bold;">AS</span> last_pr,
  <span style="color: #e5786d;">LAST</span>(repository_language) <span style="color: #8ac6f2; font-weight: bold;">as</span> <span style="color: #e5786d;">language</span>
<span style="color: #8ac6f2; font-weight: bold;">FROM</span> [githubarchive:github.timeline]
<span style="color: #8ac6f2; font-weight: bold;">WHERE</span> payload_pull_request_user_login = <span style="color: #95e454;">'mads379'</span>
<span style="color: #8ac6f2; font-weight: bold;">GROUP</span> <span style="color: #e5786d;">BY</span> repository_url
<span style="color: #8ac6f2; font-weight: bold;">ORDER</span> <span style="color: #e5786d;">BY</span> last_pr <span style="color: #8ac6f2; font-weight: bold;">DESC</span>;
</pre>
</div>

<p>
The results of the query is shown in the table below
</p>

<table border="2" cellspacing="0" cellpadding="2" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="right" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="left">repository_url</th>
<th scope="col" class="right">last_pr</th>
<th scope="col" class="left">language</th>
</tr>
</thead>
<tbody>
<tr>
<td class="left"><a href="https://github.com/diml/utop">https://github.com/diml/utop</a></td>
<td class="right">2014-11-05</td>
<td class="left">OCaml</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/bbatsov/projectile">https://github.com/bbatsov/projectile</a></td>
<td class="right">2014-10-10</td>
<td class="left">Emacs Lisp</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/jlouis/dht_bt">https://github.com/jlouis/dht_bt</a></td>
<td class="right">2014-10-07</td>
<td class="left">Erlang</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/issuu/ocaml-redis">https://github.com/issuu/ocaml-redis</a></td>
<td class="right">2014-08-26</td>
<td class="left">OCaml</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/ocaml-batteries-team/batteries-included">https://github.com/ocaml-batteries-team/batteries-included</a></td>
<td class="right">2014-05-08</td>
<td class="left">OCaml</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/cabgfx/forge">https://github.com/cabgfx/forge</a></td>
<td class="right">2013-08-17</td>
<td class="left">PHP</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/scala-ide/scala-search">https://github.com/scala-ide/scala-search</a></td>
<td class="right">2013-08-02</td>
<td class="left">Scala</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/scala/scala">https://github.com/scala/scala</a></td>
<td class="right">2013-01-26</td>
<td class="left">Scala</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/scala-ide/scala-ide">https://github.com/scala-ide/scala-ide</a></td>
<td class="right">2013-01-04</td>
<td class="left">Scala</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/scala-ide/docs">https://github.com/scala-ide/docs</a></td>
<td class="right">2012-12-11</td>
<td class="left">JavaScript</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/textmate/textmate">https://github.com/textmate/textmate</a></td>
<td class="right">2012-08-11</td>
<td class="left">C</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/avian/python-django-templates.tmbundle">https://github.com/avian/python-django-templates.tmbundle</a></td>
<td class="right">2012-08-06</td>
<td class="left">null</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/n8han/giter8">https://github.com/n8han/giter8</a></td>
<td class="right">2012-08-05</td>
<td class="left">Scala</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/avian/textmate.tmbundle">https://github.com/avian/textmate.tmbundle</a></td>
<td class="right">2012-06-02</td>
<td class="left">Ruby</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/fileability/choc-support">https://github.com/fileability/choc-support</a></td>
<td class="right">2012-05-31</td>
<td class="left">JavaScript</td>
</tr>

<tr>
<td class="left"><a href="https://github.com/leegould/GotoTab">https://github.com/leegould/GotoTab</a></td>
<td class="right">2012-04-27</td>
<td class="left">Python</td>
</tr>
</tbody>
</table>

<p>
The documentation for the BigQuery query language is <a href="https://cloud.google.com/bigquery/query-reference">here</a>. I'm
definitely going to play around with this some more. Let me know if
you come up with any other fun queries.
</p>

<p>
<b>(Added 2015-02-05)</b> <a href="https:www.twitter.com/felipehoffa">Felipe Hoffa (@felipehoffa)</a> mentioned on Twitter
that the database layout for the archive was changed in 2015. You can
find more information about it in the <a href="http://www.reddit.com/r/bigquery/comments/2s80y3/github_archive_changes_monthly_and_daily_tables/">announcement here</a>. I personally
prefer this format as the JSON from the Github Archive documentation
is stored directly in the tables which means I don't have to guess the column
names for the various nested fields.
</p>

<div class="org-src-container">

<pre class="src src-sql"><span style="color: #8ac6f2; font-weight: bold;">SELECT</span>
  repo_name,
  JSON_EXTRACT(payload, <span style="color: #95e454;">'$.pull_request.base.repo.language'</span>) <span style="color: #8ac6f2; font-weight: bold;">as</span> <span style="color: #e5786d;">language</span>,
  JSON_EXTRACT(payload, <span style="color: #95e454;">'$.pull_request.updated_at'</span>) <span style="color: #8ac6f2; font-weight: bold;">as</span> updated_at
<span style="color: #8ac6f2; font-weight: bold;">FROM</span> [githubarchive:<span style="color: #e5786d;">month</span>.201501]
<span style="color: #8ac6f2; font-weight: bold;">WHERE</span>
  <span style="color: #e5786d;">type</span> = <span style="color: #95e454;">'PullRequestEvent'</span> <span style="color: #8ac6f2; font-weight: bold;">AND</span>
  JSON_EXTRACT(payload, <span style="color: #95e454;">'$.pull_request.user.login'</span>) = <span style="color: #95e454;">'mads379'</span>
</pre>
</div>
